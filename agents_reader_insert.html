<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         üåê LIVE READER SWARM DASHBOARD
         Real-Time Sovereign Knowledge Ingestion
         ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<style>
    .live-section {
        margin-top: 48px;
        padding-top: 40px;
        border-top: 1px solid rgba(255, 255, 255, 0.07);
    }

    .live-section-hd {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 28px;
        flex-wrap: wrap;
    }

    .live-section-hd h2 {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 24px;
        font-weight: 800;
        background: linear-gradient(90deg, #00ffcc, #ff00ff);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .live-pulse {
        display: flex;
        align-items: center;
        gap: 6px;
        background: rgba(0, 255, 204, 0.08);
        border: 1px solid rgba(0, 255, 204, 0.25);
        border-radius: 20px;
        padding: 5px 12px;
        font-size: 12px;
        color: #00ffcc;
    }

    .live-pulse-dot {
        width: 7px;
        height: 7px;
        border-radius: 50%;
        background: #00ffcc;
        animation: blink 1.2s ease-in-out infinite;
    }

    .swarm-stats-bar {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 12px;
        margin-bottom: 24px;
    }

    .swarm-stat {
        background: rgba(15, 15, 15, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.07);
        border-radius: 12px;
        padding: 14px 18px;
    }

    .swarm-stat-val {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 22px;
        font-weight: 800;
    }

    .swarm-stat-lbl {
        font-size: 10px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 4px;
    }

    .source-legend {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 24px;
    }

    .source-pill {
        display: flex;
        align-items: center;
        gap: 5px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: 4px 10px;
        font-size: 11px;
    }

    .source-dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        flex-shrink: 0;
    }

    .reader-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
    }

    .reader-card {
        background: rgba(10, 10, 16, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.07);
        border-radius: 16px;
        padding: 18px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        transition: border-color 0.3s, box-shadow 0.3s;
        min-height: 280px;
    }

    .reader-card.reading {
        border-color: rgba(0, 255, 204, 0.25);
        box-shadow: 0 0 20px rgba(0, 255, 204, 0.06);
    }

    .reader-card.fetching {
        border-color: rgba(255, 215, 0, 0.2);
    }

    .reader-card.processing {
        border-color: rgba(255, 0, 255, 0.2);
    }

    .rc-header {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .rc-emoji {
        font-size: 28px;
    }

    .rc-name {
        font-weight: 700;
        font-size: 14px;
    }

    .rc-specialty {
        font-size: 11px;
        color: var(--muted);
    }

    .rc-status {
        margin-left: auto;
        font-size: 10px;
        font-weight: 700;
        padding: 3px 8px;
        border-radius: 20px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status-reading {
        background: rgba(0, 255, 204, 0.1);
        color: #00ffcc;
        border: 1px solid rgba(0, 255, 204, 0.3);
    }

    .status-fetching {
        background: rgba(255, 215, 0, 0.1);
        color: #ffd700;
        border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .status-processing {
        background: rgba(255, 0, 255, 0.1);
        color: #ff00ff;
        border: 1px solid rgba(255, 0, 255, 0.3);
    }

    .status-initializing {
        background: rgba(100, 100, 100, 0.12);
        color: #94a3b8;
        border: 1px solid rgba(100, 100, 100, 0.25);
    }

    .rc-article {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 10px;
        padding: 10px 12px;
    }

    .rc-source-tag {
        font-size: 10px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .rc-article-title {
        font-size: 12px;
        font-weight: 600;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .rc-article-title a {
        color: var(--text);
        text-decoration: none;
    }

    .rc-article-title a:hover {
        text-decoration: underline;
    }

    .rc-progress {
        height: 3px;
        background: rgba(255, 255, 255, 0.06);
        border-radius: 2px;
        overflow: hidden;
    }

    .rc-progress-fill {
        height: 100%;
        border-radius: 2px;
        background: linear-gradient(90deg, #00ffcc, #ff00ff);
        transition: width 0.2s linear;
    }

    .rc-progress-pct {
        font-size: 10px;
        color: var(--muted);
        text-align: right;
        margin-top: 3px;
    }

    .rc-text-box {
        background: rgba(0, 0, 0, 0.45);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 10px 12px;
        flex: 1;
        font-family: 'Space Grotesk', monospace;
        font-size: 11px;
        color: rgba(190, 210, 200, 0.85);
        line-height: 1.55;
        overflow: hidden;
        position: relative;
        max-height: 120px;
        min-height: 80px;
        word-break: break-word;
    }

    .rc-text-box::after {
        content: '‚ñã';
        display: inline;
        animation: blink 0.8s step-start infinite;
        color: #00ffcc;
    }

    .rc-footer {
        display: flex;
        justify-content: space-between;
        font-size: 10px;
        color: var(--muted);
    }

    .rc-kp {
        color: #ffd700;
    }
</style>

<div class="page live-section">
    <div class="live-section-hd">
        <div>
            <h2>üåê Sovereign Reader Swarm</h2>
            <p style="color:var(--muted);font-size:13px;margin-top:4px;">
                12 agents reading live articles from Wikipedia, arXiv, Hacker News, MDN, Stack Overflow &amp; Grokipedia
                ‚Äî feeding knowledge to Monroe in real-time.
            </p>
        </div>
        <div class="live-pulse" id="swarm-live-badge">
            <div class="live-pulse-dot"></div> CONNECTING...
        </div>
    </div>
    <div class="swarm-stats-bar">
        <div class="swarm-stat">
            <div class="swarm-stat-val" id="sw-agents" style="color:#00ffcc">12</div>
            <div class="swarm-stat-lbl">Active Agents</div>
        </div>
        <div class="swarm-stat">
            <div class="swarm-stat-val" id="sw-articles" style="color:#ffd700">0</div>
            <div class="swarm-stat-lbl">Articles Read</div>
        </div>
        <div class="swarm-stat">
            <div class="swarm-stat-val" id="sw-kp" style="color:#ff00ff">0</div>
            <div class="swarm-stat-lbl">Knowledge Points</div>
        </div>
        <div class="swarm-stat">
            <div class="swarm-stat-val" style="color:#3b82f6">8</div>
            <div class="swarm-stat-lbl">Knowledge Sources</div>
        </div>
    </div>
    <div class="source-legend">
        <div class="source-pill">
            <div class="source-dot" style="background:#3b82f6"></div>Wikipedia
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#ff00ff"></div>Grokipedia
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#f97316"></div>Hacker News
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#8b5cf6"></div>arXiv
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#22c55e"></div>MDN Web Docs
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#f59e0b"></div>Stack Overflow
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#e2b714"></div>Project Gutenberg
        </div>
        <div class="source-pill">
            <div class="source-dot" style="background:#00ffcc"></div>AI Research News
        </div>
    </div>
    <div class="reader-grid" id="reader-grid"></div>
</div>

<script>
    (function () {
        'use strict';
        const grid = document.getElementById('reader-grid');
        const badge = document.getElementById('swarm-live-badge');
        const swArticles = document.getElementById('sw-articles');
        const swKP = document.getElementById('sw-kp');
        const cards = new Map();
        let totalArticles = 0, totalKP = 0;

        function createCard(agent) {
            const el = document.createElement('div');
            el.className = 'reader-card initializing';
            el.id = 'rc-' + agent.id;
            el.innerHTML =
                '<div class="rc-header">' +
                '<div class="rc-emoji">' + agent.emoji + '</div>' +
                '<div><div class="rc-name">' + agent.name + '</div><div class="rc-specialty">' + agent.specialty + '</div></div>' +
                '<div class="rc-status status-initializing" id="rcs-' + agent.id + '">INIT</div>' +
                '</div>' +
                '<div class="rc-article" id="rca-' + agent.id + '">' +
                '<div class="rc-source-tag" id="rcst-' + agent.id + '">&#x23F3; Connecting...</div>' +
                '<div class="rc-article-title" id="rcat-' + agent.id + '">Waiting for first article...</div>' +
                '</div>' +
                '<div>' +
                '<div class="rc-progress"><div class="rc-progress-fill" id="rcp-' + agent.id + '" style="width:0%"></div></div>' +
                '<div class="rc-progress-pct" id="rcpp-' + agent.id + '">0%</div>' +
                '</div>' +
                '<div class="rc-text-box"><span id="rct-' + agent.id + '"></span></div>' +
                '<div class="rc-footer">' +
                '<div>&#x1F4C4; Articles: <strong id="rcac-' + agent.id + '">0</strong></div>' +
                '<div class="rc-kp">&#x2605; <strong id="rckp-' + agent.id + '">0</strong> KP</div>' +
                '</div>';
            grid.appendChild(el);
            cards.set(agent.id, {
                el: el,
                textEl: el.querySelector('#rct-' + agent.id),
                titleEl: el.querySelector('#rcat-' + agent.id),
                sourceEl: el.querySelector('#rcst-' + agent.id),
                progEl: el.querySelector('#rcp-' + agent.id),
                progPctEl: el.querySelector('#rcpp-' + agent.id),
                statusEl: el.querySelector('#rcs-' + agent.id),
                artCountEl: el.querySelector('#rcac-' + agent.id),
                kpEl: el.querySelector('#rckp-' + agent.id)
            });
        }

        function setStatus(c, status) {
            var s = (status || 'initializing').toLowerCase();
            c.el.className = 'reader-card ' + s;
            c.statusEl.className = 'rc-status status-' + s;
            c.statusEl.textContent = status || 'INIT';
        }

        function handleSnapshot(data) {
            grid.innerHTML = ''; cards.clear();
            (data.agents || []).forEach(function (agent) {
                createCard(agent);
                var c = cards.get(agent.id); if (!c) return;
                setStatus(c, agent.status || 'INITIALIZING');
                if (agent.article) {
                    c.titleEl.innerHTML = '<a href="' + agent.article.url + '" target="_blank" rel="noopener">' + agent.article.title + '</a>';
                    c.sourceEl.innerHTML = (agent.article.sourceIcon || '&#x1F310;') + ' <span style="color:' + (agent.article.sourceColor || '#fff') + '">' + agent.article.source + '</span>';
                    var pct = agent.article.totalChars > 0 ? Math.round((agent.article.processedChars / agent.article.totalChars) * 100) : 0;
                    c.progEl.style.width = pct + '%'; c.progPctEl.textContent = pct + '%';
                }
                if (agent.articlesRead > 0) c.artCountEl.textContent = agent.articlesRead;
                if (agent.knowledgePoints > 0) c.kpEl.textContent = agent.knowledgePoints.toLocaleString();
            });
            badge.innerHTML = '<div class="live-pulse-dot"></div> LIVE';
        }

        function handleAgentUpdate(data) {
            var c = cards.get(data.id);
            if (!c) { createCard(data); c = cards.get(data.id); } if (!c) return;
            setStatus(c, data.status || 'INITIALIZING');
            if (data.status === 'READING' && data.article) {
                c.titleEl.innerHTML = '<a href="' + data.article.url + '" target="_blank" rel="noopener">' + data.article.title + '</a>';
                c.sourceEl.innerHTML = (data.article.sourceIcon || '&#x1F310;') + ' <span style="color:' + (data.article.sourceColor || '#aaa') + '">' + data.article.source + '</span>';
                c.textEl.textContent = ''; c.progEl.style.width = '0%'; c.progPctEl.textContent = '0%';
            } else if (data.status === 'FETCHING') {
                c.titleEl.textContent = 'Fetching next article...'; c.sourceEl.textContent = 'Loading...';
            } else if (data.status === 'PROCESSING') {
                c.titleEl.textContent = 'Synthesizing knowledge...'; c.sourceEl.textContent = 'Processing';
                if (data.articlesRead != null) { c.artCountEl.textContent = data.articlesRead; totalArticles++; swArticles.textContent = totalArticles; }
                if (data.knowledgePoints != null) {
                    c.kpEl.textContent = data.knowledgePoints.toLocaleString();
                    var sum = 0; cards.forEach(function (x) { sum += parseInt((x.kpEl.textContent || '0').replace(/,/g, '')) || 0; }); totalKP = sum;
                    swKP.textContent = totalKP.toLocaleString();
                }
            }
        }

        function handleAgentText(data) {
            var c = cards.get(data.id); if (!c) return;
            c.textEl.textContent = (c.textEl.textContent + (data.chunk || '')).slice(-350);
            if (data.progress != null) { c.progEl.style.width = data.progress + '%'; c.progPctEl.textContent = data.progress + '%'; }
        }

        function connectSSE() {
            var es = new EventSource('/api/reader-swarm/stream');
            es.addEventListener('snapshot', function (e) { try { handleSnapshot(JSON.parse(e.data)); } catch (err) { } });
            es.addEventListener('agent-update', function (e) { try { handleAgentUpdate(JSON.parse(e.data)); } catch { } });
            es.addEventListener('agent-text', function (e) { try { handleAgentText(JSON.parse(e.data)); } catch { } });
            es.onerror = function () {
                badge.innerHTML = '<div class="live-pulse-dot" style="background:#f97316"></div> RECONNECTING...';
                setTimeout(connectSSE, 4000); es.close();
            };
        }
        connectSSE();
    })();
</script>